<%

// Function to encode URL like urlencode() in PHP

var _UrlCodeTable = {
'21' : '!', '22' :'\"', '23' : '#', '24' : '$', '25' : '%',
'26' : '&', '27' :'\'', '28' : '(', '29' : ')', '2A' : '*',
'2B' : '+', '2C' : ',', '2D' : '-', '2E' : '.', '2F' : '/',
'3A' : ':', '3B' : ';', '3C' : '<', '3D' : '=', '3E' : '>',
'3F' : '?', '40' : '@', '5B' : '[', '5C' :'\\', '5D' : ']',
'5E' : '^', '5F' : '_', '60' : '\`', '7B' : '{', '7C' : '|',
'7D' : '}', '7E' : '~', '7F' : '', '80' : 'Ä', '81' : 'Å',
'82' : 'Ç', '83' : 'É', '84' : '\Ñ', '85' : 'Ö', '86' : 'Ü',
'87' : 'á', '88' : 'à', '89' : 'â', '8A' : 'ä', '8B' : 'ã',
'8C' : 'å', '8D' : 'ç', '8E' : 'é', '8F' : 'è', '90' : 'ê',
'91' : '\ë', '92' : '\í', '93' : '\ì', '94' : '\î', '95' : 'ï',
'96' : 'ñ', '97' : 'ó', '98' : 'ò', '99' : 'ô', '9A' : 'ö',
'9B' : 'õ', '9C' : 'ú', '9D' : 'ù', '9E' : 'û', '9F' : 'ü',
'A0' : '†', 'A1' : '°', 'A2' : '¢', 'A3' : '£', 'A4' : '§',
'A5' : '•', 'A6' : '¶', 'A7' : 'ß', 'A8' : '®', 'A9' : '©',
'AA' : '™', 'AB' : '\´', 'AC' : '¨', 'AD' : '≠', 'AE' : 'Æ',
'AF' : 'Ø', 'B0' : '∞', 'B1' : '±', 'B2' : '≤', 'B3' : '≥',
'B4' : '¥', 'B5' : 'µ', 'B6' : '∂', 'B7' : '∑', 'B8' : '∏',
'B9' : 'π', 'BA' : '∫', 'BB' : '\ª', 'BC' : 'º', 'BD' : 'Ω',
'BE' : 'æ', 'BF' : 'ø', 'C0' : '¿', 'C1' : '¡', 'C2' : '¬',
'C3' : '√', 'C4' : 'ƒ', 'C5' : '≈', 'C6' : '∆', 'C7' : '«',
'C8' : '»', 'C9' : '…', 'CA' : ' ', 'CB' : 'À', 'CC' : 'Ã',
'CD' : 'Õ', 'CE' : 'Œ', 'CF' : 'œ', 'D0' : '–', 'D1' : '—',
'D2' : '“', 'D3' : '”', 'D4' : '‘', 'D5' : '’', 'D6' : '÷',
'D7' : '◊', 'D8' : 'ÿ', 'D9' : 'Ÿ', 'DA' : '⁄', 'DB' : '€',
'DC' : '‹', 'DD' : '›', 'DE' : 'ﬁ', 'DF' : 'ﬂ', 'E0' : '‡',
'E1' : '·', 'E2' : '‚', 'E3' : '„', 'E4' : '‰', 'E5' : 'Â',
'E6' : 'Ê', 'E7' : 'Á', 'E8' : 'Ë', 'E9' : 'È', 'EA' : 'Í',
'EB' : 'Î', 'EC' : 'Ï', 'ED' : 'Ì', 'EE' : 'Ó', 'EF' : 'Ô',
'F0' : '', 'F1' : 'Ò', 'F2' : 'Ú', 'F3' : 'Û', 'F4' : 'Ù',
'F5' : 'ı', 'F6' : 'ˆ', 'F7' : '˜', 'F8' : '¯', 'F9' : '˘',
'FA' : '˙', 'FB' : '˚', 'FC' : '¸', 'FD' : '˝', 'FE' : '˛',
'FF' : 'ˇ' };

function URLDecode(s) {
    s = ""+s;
    var re = new RegExp("%..","g");
    var matches = s.match(re);
    var result = "" + s.replace("+"," ");
    if (matches && matches.length) {
        for (var i=0;i<matches.length;i++) {
            if (typeof(_UrlCodeTable[matches[i].substr(1,2)])!="undefined")
                var r = new RegExp(matches[i],"g");
                result = ""+result.replace(r,_UrlCodeTable[matches[i].substr(1,2)]);

        } // cycle
    }
    return (""+result);
}

%>